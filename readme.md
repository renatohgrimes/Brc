# The One Billion Row Challenge

This is my take on the 1BRC, implemented in C#, net8.0

It was inspired by https://github.com/gunnarmorling/1brc

And by https://github.com/praeclarum/1brc (.NET Edition)

I wanted to take on the challenge but I wrote the entire solution without using unsafe code and aimed to make it as fast as possible. ðŸ™‚

To reduce allocations, I avoided using strings and instead used CRC32 hashes to map city names to weather data structs and parallelized file reading by file segments.

Generating a flamegraph with dotnet-trace made me write a custom temperature string parser.

## Running

```
dotnet build -c Release <num_of_concurrent_readers:int> <measurements_file_path:string> <print_progress:bool>
```

You can generate a mock measurements.txt file using the provided Python script:

```
python3 generator.py
```

## Tests

For testing, I used the mock measurements.txt file generated by generator.py

### Specs
```
OS: Ubuntu 24.04.2 LTS x86_64 
Kernel: 6.14.0-24-generic
CPU: Intel i5-7200U (4) @ 3.100GHz
SSD: KINGSTON SA400S37240G
Base Board Information
        Manufacturer: ASUSTeK COMPUTER INC.
        Product Name: X556URK
*-memory
       description: System Memory
       slot: System board or motherboard
       size: 12GiB
     *-bank:0
          description: SODIMM DDR4 Synchronous 2133 MHz (0.5 ns)
```

### Command
```
dotnet build -c Release 3 measurements.txt
```

### Results
```
Test #1
real    1m16.066s
user    2m53.211s
sys     0m5.129s

Test #2
real    1m17.286s
user    2m58.425s
sys     0m6.054s

Test #3
real    1m29.032s
user    2m55.316s
sys     0m6.442s

```

If I had run this on a 2017 iMac Pro with a Xeon W processor, like the .NET Edition did, I believe the results wouldâ€™ve been close to the Top 10. 
